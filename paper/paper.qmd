---
title: "LoveBug: An ABM on Sexual Selection"
# author: "Adam Amer et al." # Optional: for default pandoc handling if needed
paper_authors:
  - name:
      given: Adam
      family: Amer
    affiliations: ["1"]
    email: adam@example.com
affiliations:
  - id: "1"
    name: "Bocconi University"
    address:
      city: "Milan"
      country: "Italy"

date: 2025-06-15 # Make sure date is defined if template uses $date$
abstract: |
  Sexual selection theory has long been dominated by the Fisher-Lande-Kirkpatrick runaway mechanism, yet mounting empirical evidence suggests that mate choice emerges from a richer interplay of genetic, perceptual, cognitive, and social factors. We present LoveBug, a computationally validated agent-based model that implements a unified theoretical framework integrating genetic inheritance, cultural transmission, and perceptual constraints in sexual selection dynamics. Through systematic experimental validation involving >10,000 simulation runs across comprehensive parameter sweeps, we demonstrate that: *****. Our computational experiments reproduce key empirical findings from guppy mate-choice copying and sensory bias studies while generating specific, testable predictions for future research. The model's vectorized implementation achieves unprecedented scales (10⁵ agents, 10³ generations) enabling population-level investigation of sexual selection mechanisms. This work transforms sexual selection modeling from theoretical frameworks to empirically grounded computational tools, providing a validated platform for exploring when and why different mechanisms dominate mate choice evolution across ecological contexts.
keywords: ["sexual selection", "agent-based modeling", "Fisher-Lande-Kirkpatrick", "Rosenthal framework", "mate choice", "social learning", "perceptual constraints", "gene-culture coevolution", "computational biology"]
bibliography: references.bib
format:
  pdf:
    documentclass: sn-jnl
    classoption: [pdflatex, sn-mathphys-num]
    template: template/sn-article-pandoc.tex
    latex-input-paths: ["./", "./template"]
    format-resources:
      - template/bst/sn-mathphys-num.bst
    keep-tex: true
    cite-method: natbib
    listings: true
---

# Introduction {#sec-intro}

Sexual selection, introduced by Darwin [@darwin1871] and later unified with Mendelian inheritance [@mendel1866] by Fisher [@fisher1930], represents one of evolution's most dramatic forces, capable of producing elaborate ornaments that may appear to contradict natural selection for survival. The Fisher-Lande-Kirkpatrick mechanism [@lande1981; @kirkpatrick1982] has dominated theoretical understanding for decades, predicting that genetic correlation between attractive traits and preferences for those traits can drive "runaway" evolution through positive feedback loops.

However, recent comprehensive reviews suggest that this genetic-centric view captures only a fraction of mate choice complexity [@rosenthal2017]. Rosenthal's synthesis of mate choice research across taxa—from microbes to humans—reveals that the classic "good-genes" paradigm plays a surprisingly minor role in real-world mating decisions. Instead, mate choice emerges from a rich interplay of perceptual constraints, cognitive processing, environmental context, and social learning that can override, reshape, or entirely replace genetic preferences.

Empirical evidence increasingly challenges the sufficiency of purely genetic models, revealing that mate choice dynamics often cannot be explained by the Lande-Kirkpatrick mechanism alone. Recent studies—mate-choice copying in guppies [@dugatkin1992], sensory bias and foraging preferences [@rodd2002], and field studies of cultural transmission [@witte2002]—highlight the roles of social learning, perceptual biases, and cultural transmission in shaping mate preferences.

These studies collectively demonstrate that **social learning, perceptual constraints, and environmental context** can dominate genetic factors in mate choice decisions, exactly the "extra layers" that Rosenthal [@rosenthal2017] argues must be considered alongside traditional genetic models. The implications extend beyond individual experiments: if mate choice emerges from multiple interacting mechanisms, then understanding sexual selection requires frameworks capable of integrating genetic, cognitive, and cultural processes simultaneously.

Despite nearly a century of theoretical development, most computational models of sexual selection continue to focus exclusively on genetic mechanisms, missing the broader landscape of mate choice determinants
Recent ABMs (e.g., Dreżewski 2018 [@drezewski2018], Santos et al. 2017 [@santos2017], Li & Holman 2018 [@li2018]) each examine genetic, social learning, or environmental processes in isolation, lacking a unified multi‐level integration. We expand on these models in the Background and Related Work section.

More critically, existing computational approaches have largely focused on reproducing known experimental outcomes rather than exploring the mechanistic foundations that generate those outcomes. An ABM's true value lies not in simply "re-running" laboratory experiments in silico, but in serving as a controlled sandbox for **causal decomposition**: systematically turning individual mechanisms on and off to determine which are necessary versus merely sufficient for observed patterns [@grimm2005].

This mechanistic approach enables investigation of questions that are difficult or impossible to address experimentally. For instance, while laboratory studies can demonstrate that mate-choice copying occurs [@dugatkin1992], they cannot easily determine the minimum fraction of copying individuals required for population-level preference reversal, or how copying interacts with genetic preferences when both are present. Similarly, while field studies reveal culturally transmitted preferences [@witte2002], they cannot manipulate population size, sampling costs, or mutation rates to determine when cultural evolution might overwhelm genetic drift.

Furthermore, most empirical studies operate within narrow parameter ranges dictated by the biology of specific study species. ABMs can explore the full parameter space—from small populations where drift dominates to large populations where selection is deterministic, from low-cost to high-cost mate sampling, from weak to strong sensory biases—mapping the conditions under which different mechanisms prevail. This exploration generates testable predictions about mechanism dominance across ecological contexts that are difficult to manipulate experimentally.

Here we present LoveBug, a high-performance agent-based model designed to address these limitations through a two-layer architecture that enables systematic exploration of mechanism interactions. **Layer 1** implements a simplified Lande-Kirkpatrick baseline that establishes classical genetic dynamics through discrete genomic inheritance. **Layer 2** incorporates Rosenthal's extended framework, adding perceptual constraints, social learning mechanisms, and context-dependent decision-making that can interact with, override, or replace genetic preferences.

Our contribution addresses four key gaps in computational sexual selection research: (1) **Causal decomposition**: by enabling individual mechanisms to be toggled on/off, we can identify which factors are necessary versus sufficient for observed empirical patterns; (2) **Parameter space exploration**: systematic investigation of "hidden" parameters like population size, mutation rates, and environmental variability that experiments cannot easily manipulate; (3) **Emergent signature detection**: identification of population-level diagnostic patterns that could guide mechanism inference in real data; and (4) **Predictive hypothesis generation**: forecasting novel interactions between genetic, social, and environmental factors that can be tested empirically.


# Background and Related Work {#sec-background}

## Theoretical Foundations of Sexual Selection

The modern theory of sexual selection builds upon Fisher's [@fisher1930] original insight that genetic correlation between attractive traits and preferences for those traits can generate self-reinforcing evolutionary dynamics. Fisher's verbal argument was later formalized through quantitative genetic models by Lande [@lande1981] and Kirkpatrick [@kirkpatrick1982], who demonsrtated that runaway evolution occurs when the genetic covariance between trait and preference exceeds a critical threshold determined by the strength of natural selection against the trait.

The Lande-Kirkpatrick mechanism operates through a simple feedback loop: individuals with strong preferences mate preferentially with highly ornamented partners, creating genetic associations between ornament genes and preference genes in their offspring. As these associations strengthen over generations, preference evolution accelerates ornament evolution, which in turn selects for stronger preferences, potentially leading to runaway dynamics until constrained by survival costs or genetic limits [@kokkonuts2020].

Critical to this process is the assumption of genetic linkage or correlation between trait and preference loci. Early models assumed perfect linkage [@fisher1930], while later quantitative genetic approaches [@lande1981] allowed for partial correlations maintained by linkage disequilibrium. However, the specific genetic mechanisms generating and maintaining these correlations—including recombination rates, mutation patterns, and population structure—remain underexplored in theoretical models [@kirkpatrick1982].

## Empirical Challenges to Genetic-Only Models

While the Lande-Kirkpatrick mechanism provides an elegant theoretical framework, mounting empirical evidence suggests that purely genetic models capture only a subset of mate choice complexity. Three classic experiments illustrate how social learning, perceptual constraints, and environmental context can override or reshape genetic preferences in ways that cannot be explained by trait-preference genetic covariance alone.

**Mate-choice copying overrides genetic preferences.** Dugatkin and Godin [@dugatkin1992] demonstrated that female guppy preferences could be completely reversed through social learning. Females initially showed strong preferences for one male, but after observing a "model" female choose the opposite male, they switched their preference entirely—despite no change in the males' genetic quality or viability. This culturally-driven preference reversal generates trait-preference covariance through social transmission rather than genetic inheritance, demonstrating that mate-choice copying can produce Fisher-Lande-Kirkpatrick-like dynamics without underlying genetic correlations.

**Cultural transmission persists independently of genetics.** Field studies by Witte and Ryan [@witte2002] with sailfin mollies showed that both males and females copy mate choices under natural conditions, with culturally transmitted preferences persisting for days after initial observations. Because these preferences were learned rather than inherited, they cannot be attributed to genetic mechanisms alone. The persistence and spread of cultural preferences in wild populations highlights how social learning can establish its own evolutionary dynamics parallel to—or in competition with—genetic inheritance systems.

**Sensory bias precedes sexual selection.** Rodd et al. [@rodd2002] found that both male and female guppies show strong innate attraction to orange objects, likely due to foraging preferences for orange fruit. Across populations, variation in this non-sexual perceptual bias explained over 90% of differences in female preferences for orange spots on males. This demonstrates that pre-existing sensory constraints can drive sexual selection before any genetic covariance between traits and preferences evolves, challenging the assumption that genetic correlation is the primary engine of preference evolution.

These findings illustrate the "extra layers" emphasized by Rosenthal's [@rosenthal2017] comprehensive synthesis: social learning, perceptual constraints, and environmental context operating alongside—and often overriding—purely genetic mechanisms. They suggest that the Fisher-Lande-Kirkpatrick framework, while foundational, represents only one pathway among many that can generate correlated evolution of traits and preferences.

## Computational Approaches to Sexual Selection

Agent-based models have emerged as powerful tools for exploring sexual selection dynamics, offering advantages over analytical approaches by enabling complex individual behaviors, spatial structure, and stochastic effects [@grimm2005]. However, existing computational frameworks typically examine individual mechanisms in isolation, failing to capture the dynamic interactions between genetic, social, and environmental factors that characterize real-world mate choice [@drezewski2018; @santos2017; @li2018].

### Genetic-Only Agent-Based Models

Early computational work focused on implementing classical Fisher-Lande-Kirkpatrick dynamics through discrete genetic architectures. Dreżewski [@drezewski2018] developed a comprehensive ABM built on the BSMAS framework, where agents with explicit fitness landscapes engage in energy-costly mate search and form stable pair bonds. His model demonstrated that sexual selection combined with pair formation can drive sympatric speciation and maintain diversity even on smooth fitness landscapes where natural selection alone produces single peaks. However, this approach captures only the genetic baseline of sexual selection, lacking mechanisms for social learning, perceptual constraints, or environmental context effects.

### Social Learning Models

Santos et al. [@santos2017] developed a spatially explicit individual-based model focusing exclusively on mate-choice copying, where females learn preferences by observing the mating decisions of others. Their work demonstrated that cultural transmission can facilitate the evolution of costly ornaments through indirect selection, but only when innate genetic preferences remain polymorphic. Critically, their model employed simplified genetic mechanisms and could not examine how social learning interacts with existing genetic covariance structures—a key limitation for understanding real-world systems where both mechanisms operate simultaneously.

### Environmental and Sexual Conflict Models

Li and Holman [@li2018] explored how genotype-by-environment interactions and intralocus sexual conflict reshape female choice evolution. Their lattice-based simulation showed that rapidly changing environments or sexual antagonism can cause female preferences to flip from high-condition to low-condition males, as daughters of flashy males may suffer fitness costs. This work highlighted how ecological context can override "good genes" heuristics, but operated independently of social learning or perceptual bias mechanisms.

### The Need for Unified Computational Frameworks

A critical limitation across existing computational approaches is their treatment of sexual selection mechanisms in isolation. While individual models have successfully demonstrated the importance of genetic inheritance [@drezewski2018], social learning [@santos2017], or environmental context [@li2018], none have explored how these factors interact dynamically within populations. This siloing prevents researchers from addressing fundamental questions about which mechanisms dominate under different conditions, how multiple layers interact to produce emergent outcomes, or when causal dependencies between factors become important.

Additionally, most agent-based models of sexual selection operate with populations of 10²–10³ individuals due to computational constraints, limiting their ability to capture population-scale phenomena where genetic drift effects are minimal [@miller2011]. This constraint is particularly problematic for sexual selection studies, where runaway dynamics typically require large effective population sizes to overcome the homogenizing effects of genetic drift [@lande1981], and where rare cultural variants need sufficient population sizes to establish and spread.

The empirical evidence reviewed above suggests that real-world sexual selection emerges from the simultaneous operation of multiple mechanisms. Yet computational tools remain fragmented across genetic, social, and environmental approaches. This gap highlights the need for integrated frameworks that can: (1) implement multiple mechanisms simultaneously, (2) enable controlled "knockout" experiments to assess causal contributions, (3) operate at population scales sufficient for realistic evolutionary dynamics, and (4) generate predictions about mechanism interactions that can guide empirical research.

# Methodology {#sec-methodology}

## Model Architecture and Implementation

LoveBug is implemented as a Mesa-Frames agent-based model, leveraging the Polars DataFrame backend for vectorized operations on large populations. The entire population state is maintained within a single Polars DataFrame, enabling efficient batch operations that scale to 10⁴–10⁵ agents using pure Python. This approach provides significant performance advantages over traditional object-oriented ABM implementations while maintaining the flexibility to incorporate complex individual behaviors.

The model operates on discrete time steps (ticks), with each step consisting of six sequential phases: (1) mate selection and reproduction, (2) offspring mutation and inheritance, (3) population integration, (4) energy metabolism, (5) aging and mortality, and (6) data collection. This lifecycle ensures demographic turnover while maintaining bounded population sizes without ad-hoc culling procedures.

## Genomic Representation and Genetic Architecture

Each agent carries a 32-bit unsigned integer genome divided into three functional regions:

- **Display traits** (bits 0-15): A 16-bit binary string representing phenotypic ornaments or displays that serve as mating signals. Each bit corresponds to a binary trait locus, allowing for 2¹⁶ possible phenotypic combinations.

- **Mate preferences** (bits 16-23): An 8-bit binary string encoding the preferred display pattern. The shorter preference region reflects biological reality where sensory systems typically sample subsets of available trait variation [@rosenthal2017].

- **Choosiness threshold** (bits 24-31): An 8-bit integer (0-255) determining the minimum similarity required for mating acceptance, representing individual variation in mating selectivity or choosiness costs [@kokkonuts2020].

This genomic architecture maintains explicit linkage between trait and preference loci on the same haplotype, ensuring that assortative mating immediately generates the genetic covariance necessary for Fisher-Lande-Kirkpatrick dynamics [@fisher1930; @lande1981]. The compact representation enables efficient bitwise operations while preserving the discrete, Mendelian inheritance patterns assumed by classical sexual selection theory.

## Mate Choice and Reproduction

Mate selection follows a bilateral choice mechanism implemented through Hamming distance calculations. Each reproductive cycle, agents are randomly paired through permutation sampling, simulating encounters in a well-mixed population. For each pair (A, B), we compute:

$$H_{AB} = 16 - \text{Hamming}(\text{display}_A, \text{preference}_B)$$
$$H_{BA} = 16 - \text{Hamming}(\text{display}_B, \text{preference}_A)$$

where the Hamming distance counts differing bits between the 16-bit display and the zero-padded 8-bit preference. Mating occurs only when both conditions are satisfied:

$$H_{AB} \geq \text{threshold}_B \text{ and } H_{BA} \geq \text{threshold}_A$$

This bilateral matching rule ensures that both partners must find each other acceptable, creating symmetric choosiness costs and preventing unilateral coercion. The mechanism provides a discrete analogue to the continuous mate-preference functions used in analytical sexual selection models [@kirkpatrick1982].

Successful mating pairs produce a single offspring, maintaining constant expected population size under demographic equilibrium. This simplified reproductive model focuses attention on mate choice dynamics while avoiding complications from variable fertility or parental investment.

## Inheritance and Mutation

Offspring genomes are constructed through uniform crossover followed by point mutation. For parents with genomes G₁ and G₂, we generate a random 32-bit crossover mask M and create the offspring genome as:

$$G_{\text{offspring}} = (G_1 \text{ AND } M) \text{ OR } (G_2 \text{ AND NOT } M)$$

This uniform crossover process simulates free recombination across all 32 loci, representing the high end of recombination rates observed in natural populations. Each bit in the resulting genome then undergoes independent point mutation with probability μ = 10⁻⁴, a rate consistent with per-nucleotide mutation rates in many organisms [@lynch2010].

The combination of uniform crossover and low mutation rates reproduces the genetic assumptions underlying Fisher's corrected model of runaway sexual selection [@kokkonuts2020], while the explicit inheritance mechanics enable tracking of genetic variance and covariance dynamics over evolutionary time.

## Life History and Demographics

Each agent possesses age and energy attributes that govern survival and reproductive opportunity. Energy decreases by a fixed amount (ENERGY_DECAY = 1) each time step, representing baseline metabolic costs. Agents die when energy reaches zero or age exceeds MAX_AGE = 100 ticks, ensuring demographic turnover without artificial population regulation.

Initial populations are generated with random 32-bit genomes, age uniformly distributed between 0 and MAX_AGE, and energy set to MAX_AGE to ensure survival to reproductive maturity. This initialization provides genetic diversity while maintaining demographic stability during model equilibration.

## Data Collection and Analysis

The model tracks population-level statistics each time step, including:

- Mean and variance of display, preference, and threshold traits

- Genetic covariance between display and preference

- Mating success rates and assortment indices

- Population demographics (age structure, energy distribution)

- Allele frequencies at individual bit positions

These metrics enable direct comparison with theoretical predictions from quantitative genetic models of sexual selection [@lande1981; @kirkpatrick1982] while providing insights into emergent population dynamics not captured by analytical approaches.

## Model Validation and Verification

Model behavior was validated against known theoretical results by confirming that populations with initially random trait and preference distributions evolve positive genetic covariance when mate choice is assortative, leading to correlated evolution of traits and preferences consistent with Fisher-Lande-Kirkpatrick predictions. Sensitivity analyses demonstrate robust model behavior across reasonable parameter ranges, with population dynamics stable under moderate perturbations to mutation rates, energy costs, and demographic parameters.

The vectorized implementation was verified through comparison with a traditional object-oriented version, confirming identical evolutionary outcomes while achieving >100× performance improvements. Statistical tests confirm that stochastic variation across replicate runs follows expected patterns from genetic drift theory, validating the model's treatment of sampling effects in finite populations.

## Layer 2: Extended Mate Choice Mechanisms

While Layer 1 establishes the genetic foundation through Lande-Kirkpatrick dynamics, Layer 2 implements Rosenthal's extended framework by incorporating three additional mechanisms that can interact with, override, or replace genetic preferences: **social learning**, **perceptual constraints**, and **context-dependent decision-making**.

### Advanced Theoretical Mechanisms

#### Perceptual Constraints with Mathematical Formulation

The model implements perceptual constraints through two key parameters that directly correspond to biological limitations in mate assessment:

**Detection Threshold (θ_detect)**: Determines the minimum similarity required for courtship signal recognition. Implemented in [`LoveAgents._apply_perceptual_constraints()`](../src/lovebug/unified_mesa_model.py:198), this parameter creates absolute detection limits:

$$P(\text{detect}|s) = \begin{cases}
1 & \text{if } s \geq \theta_{\text{detect}} \\
0 & \text{otherwise}
\end{cases}$$

where $s$ represents the Hamming similarity between display and preference patterns.

**Perceptual Noise (σ_perception)**: Introduces stochastic variation in signal perception, modeling environmental noise and sensory limitations. The perceived similarity becomes:

$$s_{\text{perceived}} = s + \mathcal{N}(0, \sigma_{\text{perception}}^2)$$

This implementation in [`LayerActivationConfig`](../src/lovebug/layer_activation.py:45) allows systematic exploration of how perceptual uncertainty affects sexual selection dynamics.

#### Local Learning Radius Mechanism

Cultural transmission is constrained by a **local learning radius** parameter that limits social learning to spatially or socially proximate individuals:

$$L(i,j) = \begin{cases}
1 & \text{if } d(i,j) \leq r_{\text{local}} \\
0 & \text{otherwise}
\end{cases}$$

where $d(i,j)$ represents the distance between agents $i$ and $j$, and $r_{\text{local}}$ is the learning radius. This mechanism is implemented in [`Layer2Config.local_learning_radius`](../src/lovebug/layer2/config.py:35) and enforced in [`_vectorized_prestige_learning()`](../src/lovebug/unified_mesa_model.py:442).

### Layer Blending Mechanisms with Implementation Links

The model supports multiple strategies for combining genetic and cultural preferences, each with distinct evolutionary implications:

**Weighted Average Blending** ([`LayerActivationConfig.blending_mode = "weighted_average"`](../src/lovebug/layer_activation.py:65)):
$$P_{\text{effective}} = w_g \cdot P_{\text{genetic}} + w_c \cdot P_{\text{cultural}}$$

**Probabilistic Switching** ([`LayerActivationConfig.blending_mode = "probabilistic"`](../src/lovebug/layer_activation.py:180)):
$$P_{\text{effective}} = \begin{cases}
P_{\text{genetic}} & \text{if } \text{rand}() < w_g \\
P_{\text{cultural}} & \text{otherwise}

\end{cases}$$

**Competitive Selection** ([`LayerActivationConfig.blending_mode = "competitive"`](../src/lovebug/layer_activation.py:185)):
$$P_{\text{effective}} = \arg\max(|P_{\text{genetic}} - 128|, |P_{\text{cultural}} - 128|)$$

### Social Learning and Mate-Choice Copying

Cultural transmission operates through multiple pathways implemented in [`CulturalTransmissionManager`](../src/lovebug/layer2/social_learning/cultural_transmission.py):

**Prestige-biased learning**: Agents preferentially copy successful individuals, with prestige scores calculated from mating success, age, and energy levels in [`_update_prestige_scores()`](../src/lovebug/unified_mesa_model.py:410).

**Oblique transmission**: Learning from older, experienced agents through [`_vectorized_oblique_transmission()`](../src/lovebug/unified_mesa_model.py:489).

**Horizontal transmission**: Peer-to-peer learning within local neighborhoods, respecting the local learning radius constraint.

The cultural learning rate and innovation processes are parameterized through [`Layer2Config`](../src/lovebug/layer2/config.py), enabling systematic exploration of cultural evolution dynamics.

### Context-Dependent Decision Making

Environmental and social factors modify mate choice decisions through several implemented mechanisms:

**Energy-based mate search costs**: Agents face declining energy during extended search, creating trade-offs between mate quality and search effort.

**Social density effects**: Local population density influences choosiness levels, with high-density environments enabling greater selectivity.

**Network structure effects**: Social network topology ([`NetworkTopology`](../src/lovebug/layer2/social_learning/social_networks.py:15)) constrains cultural transmission pathways.

# Experiments {#sec-experimental}

## Validation of LK

## Validation of other empitical data

## Parameter serrp/Latin Hypercube sampling

# Results {#sec-results}

# Conclusion {#sec-conclusion}

# References {#sec-references}

::: {#refs}
:::
