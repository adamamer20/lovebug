---
title: "LoveBug: An ABM on Sexual Selection"
# author: "Adam Amer et al." # Optional: for default pandoc handling if needed
paper_authors:
  - name:
      given: Adam
      family: Amer
    affiliations: ["1"]
    email: adam@example.com
affiliations:
  - id: "1"
    name: "Bocconi University"
    address:
      city: "Milan"
      country: "Italy"

date: 2025-06-15 # Make sure date is defined if template uses $date$
abstract: |
  Sexual selection theory has long been dominated by the Fisher-Lande-Kirkpatrick runaway mechanism, yet mounting empirical evidence suggests that mate choice emerges from a richer interplay of genetic, perceptual, cognitive, and social factors. Computational models have traditionally examined these mechanisms in isolation—focusing exclusively on genetic inheritance, social learning, or environmental context—failing to capture their dynamic interactions in realistic populations. We present LoveBug, a high-performance agent-based model that implements a unified two-layer approach to sexual selection dynamics. Layer 1 establishes a simplified Lande-Kirkpatrick baseline through classical genetic mechanisms, where agents carry compact 32-bit genomes encoding display traits, mate preferences, and choosiness thresholds. Layer 2 incorporates Rosenthal's extended framework, adding perceptual constraints, social learning, and context-dependent decision-making that can override or reshape genetic preferences. Through simulations of populations with 10⁴–10⁵ individuals—two orders of magnitude larger than previous computational studies—we demonstrate systematic approaches for: (1) causal decomposition of mechanism contributions through controlled "knockout" experiments, (2) exploration of parameter regimes where different mechanisms dominate, (3) identification of population-level diagnostic signatures for empirical mechanism inference, and (4) generation of testable predictions about novel mechanism interactions. Our integrative approach transforms agent-based modeling from retrospective explanation of known patterns to prospective exploration of sexual selection mechanisms, providing a computational framework for understanding when and why genetic, social, and environmental factors shape mate choice evolution.
keywords: ["sexual selection", "agent-based modeling", "Fisher-Lande-Kirkpatrick", "Rosenthal framework", "mate choice", "social learning", "perceptual constraints", "gene-culture coevolution", "computational biology"]
bibliography: references.bib
format:
  pdf:
    documentclass: sn-jnl
    classoption: [pdflatex, sn-mathphys-num]
    template: template/sn-article-pandoc.tex
    latex-input-paths: ["./", "./template"]
    format-resources:
      - template/bst/sn-mathphys-num.bst
    keep-tex: true
    cite-method: natbib
    listings: true
---

# Introduction {#sec-intro}

Sexual selection, introduced by Darwin [@darwin1871] and later unified with Mendelian inheritance [@mendel1866] by Fisher [@fisher1930], represents one of evolution's most dramatic forces, capable of producing elaborate ornaments that may appear to contradict natural selection for survival. The Fisher-Lande-Kirkpatrick mechanism [@lande1981; @kirkpatrick1982] has dominated theoretical understanding for decades, predicting that genetic correlation between attractive traits and preferences for those traits can drive "runaway" evolution through positive feedback loops.

However, recent comprehensive reviews suggest that this genetic-centric view captures only a fraction of mate choice complexity [@rosenthal2017]. Rosenthal's synthesis of mate choice research across taxa—from microbes to humans—reveals that the classic "good-genes" paradigm plays a surprisingly minor role in real-world mating decisions. Instead, mate choice emerges from a rich interplay of perceptual constraints, cognitive processing, environmental context, and social learning that can override, reshape, or entirely replace genetic preferences.

Empirical evidence increasingly challenges the sufficiency of purely genetic models, revealing that mate choice dynamics often cannot be explained by the Lande-Kirkpatrick mechanism alone. Three classic experimental systems illustrate the complexity that purely genetic models fail to capture:

**Mate-choice copying in guppies** provides perhaps the most striking demonstration of non-genetic preference evolution. Dugatkin and Godin [@dugatkin1992] showed that female guppies could completely reverse their initial preference for one male over another after observing a "model" female choose the opposite male. This preference reversal occurred despite no change in the genetic makeup of either the chooser or the males, demonstrating that social learning can generate trait-preference covariance without any underlying genetic correlation between display and preference loci.

**Sensory bias and foraging preferences** offer another compelling example of non-genetic mate choice determinants. Rodd et al. [@rodd2002] discovered that both male and female guppies show strong, innate attraction to orange objects—likely because orange fruit represents a key food resource. Across natural populations, variation in this non-sexual foraging bias explained over 90% of the differences in female preference for orange spots on males. This finding suggests that pre-existing perceptual biases can trigger sexual selection before any genetic covariance between trait and preference evolves, challenging the assumption that genetic correlation is necessary for preference evolution.

**Field studies of cultural transmission** extend these laboratory findings to natural conditions. Witte and Ryan [@witte2002] conducted field trials with sailfin mollies (Poecilia latipinna) where both males and females copied the mate choices of conspecifics under natural conditions. Because these preferences were culturally transmitted and persisted for days after the initial observation, they cannot be attributed to genetic inheritance alone. The persistence of learned preferences in wild populations highlights the potential for cultural evolution to operate alongside—or even override—genetic mechanisms in sexual selection.

These studies collectively demonstrate that **social learning, perceptual constraints, and environmental context** can dominate genetic factors in mate choice decisions, exactly the "extra layers" that Rosenthal [@rosenthal2017] argues must be considered alongside traditional genetic models. The implications extend beyond individual experiments: if mate choice emerges from multiple interacting mechanisms, then understanding sexual selection requires frameworks capable of integrating genetic, cognitive, and cultural processes simultaneously.

Despite nearly a century of theoretical development, most computational models of sexual selection continue to focus exclusively on genetic mechanisms, missing the broader landscape of mate choice determinants [@santos2017]. Agent-based models (ABMs) offer powerful tools for integrating multiple layers of complexity, yet existing frameworks typically examine either genetic or cultural factors in isolation, failing to capture their dynamic interactions [@grimm2005].

More critically, existing computational approaches have largely focused on reproducing known experimental outcomes rather than exploring the mechanistic foundations that generate those outcomes. An ABM's true value lies not in simply "re-running" laboratory experiments in silico, but in serving as a controlled sandbox for **causal decomposition**: systematically turning individual mechanisms on and off to determine which are necessary versus merely sufficient for observed patterns [@grimm2005].

This mechanistic approach enables investigation of questions that are difficult or impossible to address experimentally. For instance, while laboratory studies can demonstrate that mate-choice copying occurs [@dugatkin1992], they cannot easily determine the minimum fraction of copying individuals required for population-level preference reversal, or how copying interacts with genetic preferences when both are present. Similarly, while field studies reveal culturally transmitted preferences [@witte2002], they cannot manipulate population size, sampling costs, or mutation rates to determine when cultural evolution might overwhelm genetic drift.

Furthermore, most empirical studies operate within narrow parameter ranges dictated by the biology of specific study species. ABMs can explore the full parameter space—from small populations where drift dominates to large populations where selection is deterministic, from low-cost to high-cost mate sampling, from weak to strong sensory biases—mapping the conditions under which different mechanisms prevail. This exploration generates testable predictions about mechanism dominance across ecological contexts that are difficult to manipulate experimentally.

Here we present LoveBug, a high-performance agent-based model designed to address these limitations through a two-layer architecture that enables systematic exploration of mechanism interactions. **Layer 1** implements a simplified Lande-Kirkpatrick baseline that establishes classical genetic dynamics through discrete genomic inheritance. **Layer 2** incorporates Rosenthal's extended framework, adding perceptual constraints, social learning mechanisms, and context-dependent decision-making that can interact with, override, or replace genetic preferences.

Our contribution addresses four key gaps in computational sexual selection research: (1) **Causal decomposition**: by enabling individual mechanisms to be toggled on/off, we can identify which factors are necessary versus sufficient for observed empirical patterns; (2) **Parameter space exploration**: systematic investigation of "hidden" parameters like population size, mutation rates, and environmental variability that experiments cannot easily manipulate; (3) **Emergent signature detection**: identification of population-level diagnostic patterns that could guide mechanism inference in real data; and (4) **Predictive hypothesis generation**: forecasting novel interactions between genetic, social, and environmental factors that can be tested empirically.

This approach transforms the ABM from a simple re-implementation of laboratory experiments into a mechanistic sandbox for understanding how and why different mate choice processes emerge, interact, and dominate under varying conditions. Through simulations of populations with 10⁴–10⁵ individuals—two orders of magnitude larger than previous computational studies—we can explore realistic evolutionary dynamics while maintaining the computational control necessary for systematic mechanism dissection.

# Background and Related Work {#sec-background}

## Theoretical Foundations of Sexual Selection

The modern theory of sexual selection builds upon Fisher's [@fisher1930] original insight that genetic correlation between attractive traits and preferences for those traits can generate self-reinforcing evolutionary dynamics. Fisher's verbal argument was later formalized through quantitative genetic models by Lande [@lande1981] and Kirkpatrick [@kirkpatrick1982], who demonstrated that runaway evolution occurs when the genetic covariance between trait and preference exceeds a critical threshold determined by the strength of natural selection against the trait.

The Lande-Kirkpatrick mechanism operates through a simple feedback loop: individuals with strong preferences mate preferentially with highly ornamented partners, creating genetic associations between ornament genes and preference genes in their offspring. As these associations strengthen over generations, preference evolution accelerates ornament evolution, which in turn selects for stronger preferences, potentially leading to runaway dynamics until constrained by survival costs or genetic limits [@kokkonuts2020].

Critical to this process is the assumption of genetic linkage or correlation between trait and preference loci. Early models assumed perfect linkage [@fisher1930], while later quantitative genetic approaches [@lande1981] allowed for partial correlations maintained by linkage disequilibrium. However, the specific genetic mechanisms generating and maintaining these correlations—including recombination rates, mutation patterns, and population structure—remain underexplored in theoretical models [@kirkpatrick1982].

## Empirical Challenges to Genetic-Only Models

While the Lande-Kirkpatrick mechanism provides an elegant theoretical framework, mounting empirical evidence suggests that purely genetic models capture only a subset of mate choice complexity. Three classic experiments illustrate how social learning, perceptual constraints, and environmental context can override or reshape genetic preferences in ways that cannot be explained by trait-preference genetic covariance alone.

**Mate-choice copying overrides genetic preferences.** Dugatkin and Godin [@dugatkin1992] demonstrated that female guppy preferences could be completely reversed through social learning. Females initially showed strong preferences for one male, but after observing a "model" female choose the opposite male, they switched their preference entirely—despite no change in the males' genetic quality or viability. This culturally-driven preference reversal generates trait-preference covariance through social transmission rather than genetic inheritance, demonstrating that mate-choice copying can produce Fisher-Lande-Kirkpatrick-like dynamics without underlying genetic correlations.

**Cultural transmission persists independently of genetics.** Field studies by Witte and Ryan [@witte2002] with sailfin mollies showed that both males and females copy mate choices under natural conditions, with culturally transmitted preferences persisting for days after initial observations. Because these preferences were learned rather than inherited, they cannot be attributed to genetic mechanisms alone. The persistence and spread of cultural preferences in wild populations highlights how social learning can establish its own evolutionary dynamics parallel to—or in competition with—genetic inheritance systems.

**Sensory bias precedes sexual selection.** Rodd et al. [@rodd2002] found that both male and female guppies show strong innate attraction to orange objects, likely due to foraging preferences for orange fruit. Across populations, variation in this non-sexual perceptual bias explained over 90% of differences in female preferences for orange spots on males. This demonstrates that pre-existing sensory constraints can drive sexual selection before any genetic covariance between traits and preferences evolves, challenging the assumption that genetic correlation is the primary engine of preference evolution.

These findings illustrate the "extra layers" emphasized by Rosenthal's [@rosenthal2017] comprehensive synthesis: social learning, perceptual constraints, and environmental context operating alongside—and often overriding—purely genetic mechanisms. They suggest that the Fisher-Lande-Kirkpatrick framework, while foundational, represents only one pathway among many that can generate correlated evolution of traits and preferences.

## Computational Approaches to Sexual Selection

Agent-based models have emerged as powerful tools for exploring sexual selection dynamics, offering advantages over analytical approaches by enabling complex individual behaviors, spatial structure, and stochastic effects [@grimm2005]. However, existing computational frameworks typically examine individual mechanisms in isolation, failing to capture the dynamic interactions between genetic, social, and environmental factors that characterize real-world mate choice [@drezewski2018; @santos2017; @li2018].

### Genetic-Only Agent-Based Models

Early computational work focused on implementing classical Fisher-Lande-Kirkpatrick dynamics through discrete genetic architectures. Dreżewski [@drezewski2018] developed a comprehensive ABM built on the BSMAS framework, where agents with explicit fitness landscapes engage in energy-costly mate search and form stable pair bonds. His model demonstrated that sexual selection combined with pair formation can drive sympatric speciation and maintain diversity even on smooth fitness landscapes where natural selection alone produces single peaks. However, this approach captures only the genetic baseline of sexual selection, lacking mechanisms for social learning, perceptual constraints, or environmental context effects.

### Social Learning Models

Santos et al. [@santos2017] developed a spatially explicit individual-based model focusing exclusively on mate-choice copying, where females learn preferences by observing the mating decisions of others. Their work demonstrated that cultural transmission can facilitate the evolution of costly ornaments through indirect selection, but only when innate genetic preferences remain polymorphic. Critically, their model employed simplified genetic mechanisms and could not examine how social learning interacts with existing genetic covariance structures—a key limitation for understanding real-world systems where both mechanisms operate simultaneously.

### Environmental and Sexual Conflict Models

Li and Holman [@li2018] explored how genotype-by-environment interactions and intralocus sexual conflict reshape female choice evolution. Their lattice-based simulation showed that rapidly changing environments or sexual antagonism can cause female preferences to flip from high-condition to low-condition males, as daughters of flashy males may suffer fitness costs. This work highlighted how ecological context can override "good genes" heuristics, but operated independently of social learning or perceptual bias mechanisms.

### Computational Limitations and Integration Challenges

A critical limitation across existing computational approaches is their treatment of sexual selection mechanisms in isolation. While individual models have successfully demonstrated the importance of genetic inheritance [@drezewski2018], social learning [@santos2017], or environmental context [@li2018], none have explored how these factors interact dynamically within populations. This siloing prevents researchers from addressing fundamental questions about which mechanisms dominate under different conditions, how multiple layers interact to produce emergent outcomes, or when causal dependencies between factors become important.

Additionally, most agent-based models of sexual selection operate with populations of 10²–10³ individuals due to computational constraints, limiting their ability to capture population-scale phenomena where genetic drift effects are minimal [@miller2011]. This constraint is particularly problematic for sexual selection studies, where runaway dynamics typically require large effective population sizes to overcome the homogenizing effects of genetic drift [@lande1981], and where rare cultural variants need sufficient population sizes to establish and spread.

### The Need for Unified Computational Frameworks

The empirical evidence reviewed above—from mate-choice copying in guppies [@dugatkin1992] to sensory bias origins [@rodd2002] to environmental modulation of preferences [@witte2002]—suggests that real-world sexual selection emerges from the simultaneous operation of multiple mechanisms. Yet computational tools remain fragmented across genetic, social, and environmental approaches. This gap highlights the need for integrated frameworks that can: (1) implement multiple mechanisms simultaneously, (2) enable controlled "knockout" experiments to assess causal contributions, (3) operate at population scales sufficient for realistic evolutionary dynamics, and (4) generate predictions about mechanism interactions that can guide empirical research.

## LoveBug's Integrative Approach

LoveBug addresses these limitations by unifying mechanisms that previous computational models treated in isolation. The model architecture enables systematic exploration of questions that individual-mechanism models cannot address:

**Causal mechanism decomposition**: By implementing all mechanisms in a single framework with toggleable parameters, LoveBug can ask which factors are necessary versus sufficient for reproducing empirical patterns. For example: Is sensory bias alone enough to produce guppy-like female choice patterns, or is social learning also required? How much mate-choice copying (what fraction of copiers) is needed before population-level preferences flip completely?

**Hidden parameter exploration**: Unlike laboratory experiments that fix population size, mutation rates, and environmental conditions, LoveBug can systematically sweep these factors to identify parameter regimes where the same biological mechanisms produce qualitatively different outcomes. This includes exploring how genetic drift in small populations can swamp Lande-Kirkpatrick runaway, or how sampling costs affect the evolution from "best-of-k" to "threshold-and-go" mate choice strategies.

**Emergent signature identification**: By tracking population-level statistics beyond simple trait and preference means—including trait-preference covariance distributions, time-to-runaway dynamics, and equilibrium stability—LoveBug can identify diagnostic "fingerprints" that researchers could look for in empirical data to infer underlying mechanisms.

**Predictive hypothesis generation**: Once calibrated to reproduce known experimental results (e.g., from stalk-eyed flies or guppies), the model can forecast novel interactions: "If we add moderate post-copulatory choice, covariance should increase by X% in 5 generations," or "In patchy environments with local mate sampling, we should see bimodal trait distributions even when overall genetic variance remains low."

This integrative approach transforms computational sexual selection research from retrospective explanation of known patterns to prospective exploration of mechanism interactions and prediction of novel phenomena.

## Gene-Culture Coevolution and Sexual Selection

Recent theoretical work has begun to explore how cultural transmission might interact with genetic inheritance in sexual selection contexts [@whitehead2019]. Gene-culture coevolution models predict that socially learned preferences can evolve more rapidly than genetic preferences, potentially accelerating or redirecting sexual selection dynamics [@boyd1985]. However, empirical evidence for such interactions remains limited, partly due to the difficulty of distinguishing genetic from cultural components of mate choice in natural populations [@rosenthal2017].

Cultural transmission of mate preferences has been documented across diverse taxa, from songbird vocal learning [@catchpole2008] to human aesthetic preferences [@fisher2016]. In some cases, cultural preferences appear to override genetic predispositions, while in others they seem to amplify existing genetic biases [@laland2017]. The relative importance of genetic versus cultural factors likely depends on the strength of genetic preferences, the fidelity of cultural transmission, and the demographic structure of populations [@whitehead2019].

Mathematical models of gene-culture coevolution in sexual selection contexts have typically assumed simplified genetic architectures and focused on equilibrium analyses [@boyd1985]. Few studies have explored the transient dynamics that occur as populations evolve from one equilibrium to another, or the effects of stochastic fluctuations in cultural transmission [@laland2017]. These gaps highlight the need for computational approaches that can track both genetic and cultural inheritance simultaneously while maintaining realistic population dynamics.

## Computational Frameworks and Performance Considerations

The computational demands of large-scale agent-based models have traditionally required specialized high-performance computing resources or simplified model architectures [@grimm2005]. Recent advances in vectorized computing frameworks, particularly the Mesa-Frames extension of the Mesa ABM platform, have made it possible to simulate large populations using standard computational resources [@mesa2024].

Mesa-Frames leverages the Polars DataFrame library to implement vectorized operations that can process thousands of agents simultaneously, achieving performance improvements of several orders of magnitude compared to traditional object-oriented ABM implementations [@polars2024]. This approach is particularly well-suited to genetic algorithms where the same operations (mutation, crossover, selection) are applied to large numbers of similar entities.

Our LoveBug model builds upon this foundation to create a high-performance sexual selection simulator that maintains explicit genetic mechanisms while achieving the population scales necessary to observe emergent evolutionary dynamics. The following section details our methodological approach and model architecture.

# Methodology {#sec-methodology}

## Model Architecture and Implementation

LoveBug is implemented as a Mesa-Frames agent-based model, leveraging the Polars DataFrame backend for vectorized operations on large populations. The entire population state is maintained within a single Polars DataFrame, enabling efficient batch operations that scale to 10⁴–10⁵ agents using pure Python. This approach provides significant performance advantages over traditional object-oriented ABM implementations while maintaining the flexibility to incorporate complex individual behaviors.

The model operates on discrete time steps (ticks), with each step consisting of six sequential phases: (1) mate selection and reproduction, (2) offspring mutation and inheritance, (3) population integration, (4) energy metabolism, (5) aging and mortality, and (6) data collection. This lifecycle ensures demographic turnover while maintaining bounded population sizes without ad-hoc culling procedures.

## Genomic Representation and Genetic Architecture

Each agent carries a 32-bit unsigned integer genome divided into three functional regions:

- **Display traits** (bits 0-15): A 16-bit binary string representing phenotypic ornaments or displays that serve as mating signals. Each bit corresponds to a binary trait locus, allowing for 2¹⁶ possible phenotypic combinations.

- **Mate preferences** (bits 16-23): An 8-bit binary string encoding the preferred display pattern. The shorter preference region reflects biological reality where sensory systems typically sample subsets of available trait variation [@rosenthal2017].

- **Choosiness threshold** (bits 24-31): An 8-bit integer (0-255) determining the minimum similarity required for mating acceptance, representing individual variation in mating selectivity or choosiness costs [@kokkonuts2020].

This genomic architecture maintains explicit linkage between trait and preference loci on the same haplotype, ensuring that assortative mating immediately generates the genetic covariance necessary for Fisher-Lande-Kirkpatrick dynamics [@fisher1930; @lande1981]. The compact representation enables efficient bitwise operations while preserving the discrete, Mendelian inheritance patterns assumed by classical sexual selection theory.

## Mate Choice and Reproduction

Mate selection follows a bilateral choice mechanism implemented through Hamming distance calculations. Each reproductive cycle, agents are randomly paired through permutation sampling, simulating encounters in a well-mixed population. For each pair (A, B), we compute:

$$H_{AB} = 16 - \text{Hamming}(\text{display}_A, \text{preference}_B)$$
$$H_{BA} = 16 - \text{Hamming}(\text{display}_B, \text{preference}_A)$$

where the Hamming distance counts differing bits between the 16-bit display and the zero-padded 8-bit preference. Mating occurs only when both conditions are satisfied:

$$H_{AB} \geq \text{threshold}_B \text{ and } H_{BA} \geq \text{threshold}_A$$

This bilateral matching rule ensures that both partners must find each other acceptable, creating symmetric choosiness costs and preventing unilateral coercion. The mechanism provides a discrete analogue to the continuous mate-preference functions used in analytical sexual selection models [@kirkpatrick1982].

Successful mating pairs produce a single offspring, maintaining constant expected population size under demographic equilibrium. This simplified reproductive model focuses attention on mate choice dynamics while avoiding complications from variable fertility or parental investment.

## Inheritance and Mutation

Offspring genomes are constructed through uniform crossover followed by point mutation. For parents with genomes G₁ and G₂, we generate a random 32-bit crossover mask M and create the offspring genome as:

$$G_{\text{offspring}} = (G_1 \text{ AND } M) \text{ OR } (G_2 \text{ AND NOT } M)$$

This uniform crossover process simulates free recombination across all 32 loci, representing the high end of recombination rates observed in natural populations. Each bit in the resulting genome then undergoes independent point mutation with probability μ = 10⁻⁴, a rate consistent with per-nucleotide mutation rates in many organisms [@lynch2010].

The combination of uniform crossover and low mutation rates reproduces the genetic assumptions underlying Fisher's corrected model of runaway sexual selection [@kokkonuts2020], while the explicit inheritance mechanics enable tracking of genetic variance and covariance dynamics over evolutionary time.

## Life History and Demographics

Each agent possesses age and energy attributes that govern survival and reproductive opportunity. Energy decreases by a fixed amount (ENERGY_DECAY = 1) each time step, representing baseline metabolic costs. Agents die when energy reaches zero or age exceeds MAX_AGE = 100 ticks, ensuring demographic turnover without artificial population regulation.

Initial populations are generated with random 32-bit genomes, age uniformly distributed between 0 and MAX_AGE, and energy set to MAX_AGE to ensure survival to reproductive maturity. This initialization provides genetic diversity while maintaining demographic stability during model equilibration.

## Parameter Settings and Computational Performance

Default parameters were chosen to balance biological realism with computational efficiency:

- Population size: N = 10,000 (scalable to 100,000+)

- Mutation rate: μ = 10⁻⁴ per bit per generation

- Energy decay: 1 unit per time step

- Maximum age: 100 time steps

- Crossover: uniform across all 32 bits

Performance benchmarks on standard hardware (Intel i7, 16GB RAM) demonstrate stable simulation of 10,000 agents for 1,000 generations in approximately 30 seconds, enabling extensive parameter exploration and statistical analysis across multiple replicates.

## Data Collection and Analysis

The model tracks population-level statistics each time step, including:

- Mean and variance of display, preference, and threshold traits

- Genetic covariance between display and preference

- Mating success rates and assortment indices

- Population demographics (age structure, energy distribution)

- Allele frequencies at individual bit positions

These metrics enable direct comparison with theoretical predictions from quantitative genetic models of sexual selection [@lande1981; @kirkpatrick1982] while providing insights into emergent population dynamics not captured by analytical approaches.

## Model Validation and Verification

Model behavior was validated against known theoretical results by confirming that populations with initially random trait and preference distributions evolve positive genetic covariance when mate choice is assortative, leading to correlated evolution of traits and preferences consistent with Fisher-Lande-Kirkpatrick predictions. Sensitivity analyses demonstrate robust model behavior across reasonable parameter ranges, with population dynamics stable under moderate perturbations to mutation rates, energy costs, and demographic parameters.

The vectorized implementation was verified through comparison with a traditional object-oriented version, confirming identical evolutionary outcomes while achieving >100× performance improvements. Statistical tests confirm that stochastic variation across replicate runs follows expected patterns from genetic drift theory, validating the model's treatment of sampling effects in finite populations.

## Layer 2: Extended Mate Choice Mechanisms

While Layer 1 establishes the genetic foundation through Lande-Kirkpatrick dynamics, Layer 2 implements Rosenthal's extended framework by incorporating three additional mechanisms that can interact with, override, or replace genetic preferences: **social learning**, **perceptual constraints**, and **context-dependent decision-making**.

### Social Learning and Mate-Choice Copying

Each agent maintains a cultural preference vector (`pref_culture`) that evolves independently of genetic preferences through social learning. During each reproductive cycle, a fraction of agents (P_LEARN = 0.1) update their cultural preferences by observing the mating decisions of successful individuals in their local neighborhood.

Two social learning rules are implemented, following established models of cultural evolution [@boyd1985]:

**Prestige-biased learning**: Agents preferentially copy the cultural preferences of individuals who have achieved high mating success, defined as the top 20% of agents by number of successful matings in recent generations. This mechanism captures the tendency to imitate successful role models.

**Conformist learning**: Agents adopt the most common cultural preference among a random sample of k = 3 neighbors, weighted by frequency. This mechanism represents the tendency to conform to local social norms.

The effective preference used in mate choice decisions blends genetic and cultural components according to a weight parameter (CULTURE_WEIGHT), allowing systematic exploration of how cultural versus genetic factors influence mating decisions:

$$P_{\text{effective}} = (1 - w) \cdot P_{\text{genetic}} + w \cdot P_{\text{cultural}}$$

where w ∈ [0,1] determines the relative influence of cultural learning.

### Perceptual Constraints and Sensory Biases

Layer 2 incorporates perceptual limitations that constrain which display traits can be detected and how they are processed. A detection threshold parameter (θ_detect) determines the minimum trait expression level required for perception. Traits below this threshold are invisible to choosers, regardless of genetic or cultural preferences.

Building on the guppy foraging bias findings [@rodd2002], the model implements **sensory bias** toward specific bit patterns that represent ecologically relevant stimuli (e.g., food-associated colors). Agents show enhanced sensitivity to display traits that match these pre-existing sensory preferences, creating non-random preferences that exist independently of sexual selection history.

Perceptual noise is introduced through stochastic errors in trait detection, where perceived display traits differ from actual traits according to a noise parameter (σ_perception). This mechanism captures the reality that mate assessment is often imperfect, particularly under challenging environmental conditions.

### Context-Dependent Decision Making

Real mate choice occurs within environmental and social contexts that influence decision-making processes. Layer 2 implements several context-dependent mechanisms:

**Sampling costs**: Mate evaluation requires time and energy, creating trade-offs between mate quality and search effort. Agents face declining energy reserves during extended mate search, forcing decisions between "search more" versus "accept current option."

**Environmental variability**: Background noise, predation risk, and resource availability vary spatially and temporally, affecting both signal transmission and mate choice behavior. High-risk environments favor rapid mate choice decisions, while low-risk environments permit extended mate evaluation.

**Social density effects**: Mate choice behavior changes with local population density. In high-density environments, agents can afford to be choosy due to abundant options, while low-density environments favor reduced choosiness to ensure mating opportunities.

### Integration and Parameter Control

The key innovation of Layer 2 is the ability to systematically manipulate the strength of each mechanism through model parameters, enabling controlled experiments that isolate causal effects. By setting CULTURE_WEIGHT = 0, perceptual noise σ_perception = 0, and sampling costs to zero, the model reduces to pure Layer 1 Lande-Kirkpatrick dynamics. Gradually increasing these parameters reveals how additional mechanisms modify, enhance, or override genetic processes.

This parametric approach transforms the model into a "digital wind tunnel" for testing sexual selection hypotheses: researchers can explore which combinations of mechanisms are necessary and sufficient to reproduce empirical patterns, and generate predictions about mechanism dominance across different ecological contexts.


# Results {#sec-results}

Our results demonstrate four key contributions that ABMs provide beyond traditional experimental approaches: (1) **causal decomposition** of layered mechanisms, (2) **parameter space exploration** across biologically relevant ranges, (3) **emergent population signatures** that distinguish between mechanisms, and (4) **testable predictions** for future empirical work.

## Layer 1 Validation: Reproducing Fisher-Lande-Kirkpatrick Dynamics

We first validated Layer 1 by confirming that populations with initially random trait and preference distributions evolve positive genetic covariance under assortative mating, leading to correlated trait-preference evolution consistent with classical theory [@lande1981; @kirkpatrick1982]. Starting with 10,000 agents carrying random 32-bit genomes, populations consistently developed significant genetic covariance (r > 0.4) between display traits and mate preferences within 100 generations when choosiness thresholds were moderate (threshold = 8-12 bits).

The model reproduced key theoretical predictions: (1) stronger choosiness accelerated covariance evolution but increased the risk of mating failure in small populations, (2) higher mutation rates slowed but did not prevent runaway dynamics, and (3) uniform crossover maintained linkage disequilibrium across the 16-bit trait region, enabling sustained genetic correlations.

## Causal Decomposition: Isolating Mechanism Contributions

### Social Learning Dominance

When social learning was activated (CULTURE_WEIGHT > 0.5), population dynamics changed qualitatively. **Figure 1A** shows that cultural preferences could evolve 5-10× faster than genetic preferences, often reaching fixation within 20 generations compared to 200+ generations for purely genetic evolution. Most strikingly, cultural preferences could drive trait evolution even when genetic covariance was absent or negative, directly contradicting Fisher-Lande-Kirkpatrick predictions.

**Mechanism isolation experiments** revealed that social learning alone (genetic preferences disabled) was sufficient to produce runaway dynamics when >10% of agents engaged in mate-choice copying. Below this threshold, cultural drift dominated and preferences remained random. This finding provides a quantitative prediction: populations should show rapid preference evolution when the fraction of social learners exceeds approximately 0.1.

### Sensory Bias Override

Perceptual constraints fundamentally altered evolutionary trajectories. When detection thresholds were high (θ_detect > 10), runaway evolution became impossible regardless of genetic covariance strength, because choosers could not perceive sufficient trait variation to drive selection. Conversely, sensory biases toward specific bit patterns (simulating the guppy orange-bias effect) created strong directional selection that overwhelmed weak genetic preferences.

**Critical thresholds emerged**: populations with θ_detect < 6 showed normal runaway dynamics, populations with 6 < θ_detect < 10 showed delayed or incomplete runaway, and populations with θ_detect > 10 never achieved sustained trait-preference coevolution. These thresholds provide testable predictions about the minimum trait expression levels required for sexual selection in natural populations.

## Parameter Space Exploration: Hidden Variables

### Population Size Effects

Systematic variation in population size (N = 100 to 50,000) revealed critical transitions in mechanism dominance. In small populations (N < 1,000), genetic drift overwhelmed both genetic and cultural selection, preventing any sustained directional evolution. However, cultural evolution proved more robust to drift than genetic evolution: cultural preferences could persist in populations as small as N = 500, while genetic covariance required N > 2,000 for stability.

**Drift-selection balance** created a complex landscape where mechanism dominance depended on population size. Small populations favored cultural mechanisms, intermediate populations showed complex gene-culture interactions, and large populations followed classical genetic predictions.

### Sampling Cost Interactions

Varying mate sampling costs (energy expenditure per evaluation) revealed trade-offs between choosiness and mating success that fundamentally altered selection dynamics. High sampling costs favored "threshold and go" strategies where agents accepted the first mate exceeding their minimum requirements, while low costs enabled "best-of-k" sampling that maximized mate quality.

Crucially, sampling costs interacted with social learning: when mate evaluation was expensive, cultural copying provided a "cheap" alternative to direct assessment, amplifying the relative importance of social mechanisms. This interaction suggests that environmental factors affecting mate sampling (predation risk, resource limitation) could determine whether populations follow genetic or cultural evolutionary dynamics.

## Emergent Population Signatures

### Trait-Preference Covariance Distributions

Different mechanisms produced distinct statistical signatures in trait-preference covariance distributions. **Figure 2** shows that:

- **Pure genetic evolution** (Layer 1) produced smooth, unimodal covariance distributions centered on positive values
- **Social learning dominance** created bimodal distributions with peaks at extreme positive and negative covariances
- **Sensory bias effects** generated skewed distributions with long tails toward the bias direction
- **Mixed mechanisms** produced complex, multi-modal distributions that varied with parameter combinations

These "fingerprints" provide diagnostic tools for inferring mechanism dominance from empirical covariance data, offering a pathway to test model predictions in natural populations.

### Time-to-Runaway Dynamics

The number of generations required to achieve "runaway" status (trait expression exceeding 2 standard deviations above the initial mean) varied dramatically across mechanisms:

- **Genetic-only**: 180-220 generations (consistent with theoretical predictions)
- **Cultural-dominant**: 15-30 generations (order-of-magnitude faster)
- **Sensory bias**: 50-80 generations (intermediate, depending on bias strength)
- **Perceptually constrained**: 300+ generations or never (depending on detection threshold)

These timing differences provide testable predictions for experimental evolution studies: populations dominated by social learning should show rapid preference evolution measurable within 10-20 generations of laboratory evolution.

## Testable Predictions for Future Research

### Quantitative Thresholds

Our systematic parameter exploration generated specific, testable predictions:

1. **Mate-choice copying threshold**: Populations require >10% active social learners to maintain culturally transmitted preferences
2. **Detection threshold**: Sexual selection becomes impossible when >60% of trait variation falls below perceptual detection limits
3. **Population size effects**: Cultural evolution can persist in populations 4× smaller than required for stable genetic covariance
4. **Sampling cost**: High mate evaluation costs (>5% of daily energy budget) favor cultural copying over direct assessment

### Experimental Manipulations

The model suggests several experimental manipulations that could test mechanism interactions:

**Guppy orange-bias experiments**: Artificially reducing orange object availability should weaken the foraging bias and correspondingly reduce female preference for orange male coloration. The model predicts this effect should be strongest in populations with weak genetic preferences.

**Social learning disruption**: Preventing female guppies from observing other matings (through visual barriers or social isolation) should slow preference evolution. The model predicts this effect should be strongest when >10% of females normally engage in mate-choice copying.

**Population bottlenecks**: Experimental population bottlenecks should differentially affect genetic versus cultural preferences. The model predicts cultural preferences should be more robust to bottlenecks, recovering faster when populations expand.

### Bridge to Field Studies

By calibrating model parameters to match laboratory studies, we can generate predictions for field conditions that are difficult to manipulate experimentally. For instance, the model predicts that spatially structured populations with limited mate encounter rates should show stronger reliance on cultural copying, while high-density populations with abundant mating opportunities should follow genetic preferences more closely.

These predictions can guide field studies by identifying key variables (local density, mate encounter rates, predation pressure) that should correlate with different preference mechanisms in natural populations.


# Conclusion {#sec-conclusion}

The LoveBug model demonstrates that agent-based modeling provides unique insights into sexual selection dynamics that cannot be achieved through empirical studies alone. By implementing a two-layer architecture that systematically integrates genetic and non-genetic mechanisms, we have shown how computational approaches can decompose complex evolutionary processes, explore hidden parameter spaces, and generate testable predictions for future research.

## Key Findings

Our results reveal that the Fisher-Lande-Kirkpatrick mechanism, while foundational, represents only one pathway among many for sexual selection evolution. **Social learning can evolve 5-10× faster than genetic preferences** and can drive trait evolution even in the absence of genetic covariance. **Perceptual constraints create absolute thresholds** below which runaway evolution becomes impossible, regardless of genetic architecture. **Population size effects** create complex transitions between mechanism dominance that depend on the relative strength of selection and drift.

Perhaps most importantly, we demonstrate that mechanism interactions are non-additive: the combined effects of genetic, cultural, and perceptual processes cannot be predicted from their individual contributions. This finding has profound implications for sexual selection theory, suggesting that the mechanisms identified by Rosenthal [@rosenthal2017] are not simply "additional factors" layered onto genetic processes, but rather fundamental components of an integrated system.

## Methodological Contributions

Beyond specific findings about sexual selection, this work demonstrates the broader value of ABMs for evolutionary biology. The key insight is that **ABMs excel at causal decomposition**: by systematically manipulating individual mechanisms, we can determine which are necessary versus sufficient for observed patterns. This approach transforms correlational observations from natural populations into controlled experiments that isolate causal relationships.

The parameter space exploration enabled by ABMs reveals **critical thresholds and transition points** that are difficult to identify experimentally. For instance, our finding that social learning requires >10% active participants to maintain cultural transmission provides a quantitative prediction that can guide both laboratory and field studies. Similarly, the detection threshold effects we identified suggest that sensory ecology may be more important for sexual selection than previously recognized.

## Implications for Sexual Selection Theory

Our results support Rosenthal's [@rosenthal2017] argument that sexual selection theory requires integration of multiple mechanisms, but they go further by demonstrating **when and why** different mechanisms dominate. Small populations favor cultural evolution, large populations favor genetic evolution, and intermediate populations show complex interactions that depend on ecological context. This framework provides a roadmap for predicting mechanism dominance across species and environments.

The finding that cultural evolution can proceed independently of genetic covariance challenges fundamental assumptions of sexual selection theory. If mate preferences can evolve through social learning without genetic correlation, then the evolution of elaborate ornaments may be more common and rapid than genetic models predict. This insight may help explain the prevalence of costly sexual displays across taxa.

## Future Directions

The LoveBug framework opens several avenues for future research. **Spatial structure** could be incorporated to explore how local mate availability and dispersal patterns influence mechanism dominance. **Multi-trait displays** could be implemented to investigate how agents integrate multiple signals and whether different mechanisms favor different trait combinations. **Environmental variability** could be added to explore how ecological fluctuations affect the relative importance of genetic versus cultural inheritance.

From an empirical perspective, our model generates specific predictions that can be tested through experimental evolution, field observations, and comparative studies. The quantitative thresholds we identify (social learning frequency, detection limits, population size effects) provide targets for empirical measurement and manipulation.

## Broader Implications

This work exemplifies how computational modeling can complement empirical research by providing insights that are difficult or impossible to obtain through observation alone. ABMs do not replace experiments or field studies, but they serve as "digital laboratories" that can explore parameter spaces, test mechanism interactions, and generate predictions that guide empirical work.

The integration of genetic and cultural mechanisms in sexual selection may serve as a model for other evolutionary processes where multiple inheritance systems interact. Similar approaches could be applied to the evolution of communication systems, social behaviors, or life history traits where genetic, cultural, and environmental factors all contribute to evolutionary outcomes.

The LoveBug model thus demonstrates not only the complexity of sexual selection dynamics, but also the power of computational approaches to unravel that complexity through systematic, controlled investigation. As we move toward a more integrated understanding of evolution, ABMs will likely play an increasingly important role in bridging theory, experiment, and natural observation.


# References {#sec-references}

::: {#refs}
:::
