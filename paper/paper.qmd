---
title: "LoveBug: An ABM on Sexual Selection"
# author: "Adam Amer et al." # Optional: for default pandoc handling if needed
paper_authors:
  - name:
      given: Adam
      family: Amer
    affiliations: ["1"]
    email: adam@example.com
affiliations:
  - id: "1"
    name: "Bocconi University"
    address:
      city: "Milan"
      country: "Italy"

date: 2025-06-15 # Make sure date is defined if template uses $date$
abstract: |
  Sexual selection theory has long been dominated by the Fisher-Lande-Kirkpatrick runaway mechanism, yet mounting empirical evidence suggests that mate choice emerges from a richer interplay of genetic, perceptual, cognitive, and social factors. We present LoveBug, a computationally validated agent-based model that implements a unified theoretical framework integrating genetic inheritance, cultural transmission, and perceptual constraints in sexual selection dynamics. Through systematic experimental validation involving >10,000 simulation runs across comprehensive parameter sweeps, we demonstrate that: *****. Our computational experiments reproduce key empirical findings from guppy mate-choice copying and sensory bias studies while generating specific, testable predictions for future research. The model's vectorized implementation achieves unprecedented scales (10⁵ agents, 10³ generations) enabling population-level investigation of sexual selection mechanisms. This work transforms sexual selection modeling from theoretical frameworks to empirically grounded computational tools, providing a validated platform for exploring when and why different mechanisms dominate mate choice evolution across ecological contexts.
keywords: ["sexual selection", "agent-based modeling", "Fisher-Lande-Kirkpatrick", "Rosenthal framework", "mate choice", "social learning", "perceptual constraints", "gene-culture coevolution", "computational biology"]
bibliography: references.bib
format:
  pdf:
    documentclass: sn-jnl
    classoption: [pdflatex, sn-mathphys-num]
    template: template/sn-article-pandoc.tex
    latex-input-paths: ["./", "./template"]
    format-resources:
      - template/bst/sn-mathphys-num.bst
    keep-tex: true
    cite-method: natbib
    listings: true
---

# Introduction {#sec-intro}

Sexual selection, introduced by Darwin [@darwin1871] and later unified with Mendelian inheritance [@mendel1866] by Fisher [@fisher1930], represents one of evolution's most dramatic forces, capable of producing elaborate ornaments that may appear to contradict natural selection for survival. The Fisher-Lande-Kirkpatrick mechanism [@lande1981; @kirkpatrick1982] has dominated theoretical understanding for decades, predicting that genetic correlation between attractive traits and preferences for those traits can drive "runaway" evolution through positive feedback loops.

However, recent comprehensive reviews suggest that this genetic-centric view captures only a fraction of mate choice complexity [@rosenthal2017]. Rosenthal's synthesis of mate choice research across taxa—from microbes to humans—reveals that the classic "good-genes" paradigm plays a surprisingly minor role in real-world mating decisions. Instead, mate choice emerges from a rich interplay of perceptual constraints, cognitive processing, environmental context, and social learning that can override, reshape, or entirely replace genetic preferences.

Empirical evidence increasingly challenges the sufficiency of purely genetic models, revealing that mate choice dynamics often cannot be explained by the Lande-Kirkpatrick mechanism alone. Recent studies—mate-choice copying in guppies [@dugatkin1992], sensory bias and foraging preferences [@rodd2002], and field studies of cultural transmission [@witte2002]—highlight the roles of social learning, perceptual biases, and cultural transmission in shaping mate preferences.

These studies collectively demonstrate that **social learning, perceptual constraints, and environmental context** can dominate genetic factors in mate choice decisions, exactly the "extra layers" that Rosenthal [@rosenthal2017] argues must be considered alongside traditional genetic models. The implications extend beyond individual experiments: if mate choice emerges from multiple interacting mechanisms, then understanding sexual selection requires frameworks capable of integrating genetic, cognitive, and cultural processes simultaneously.

Despite nearly a century of theoretical development, most computational models of sexual selection continue to focus exclusively on genetic mechanisms, missing the broader landscape of mate choice determinants
Recent ABMs (e.g., Dreżewski 2018 [@drezewski2018], Santos et al. 2017 [@santos2017], Li & Holman 2018 [@li2018]) each examine genetic, social learning, or environmental processes in isolation, lacking a unified multi‐level integration. We expand on these models in the Background and Related Work section.

More critically, existing computational approaches have largely focused on reproducing known experimental outcomes rather than exploring the mechanistic foundations that generate those outcomes. An ABM's true value lies not in simply "re-running" laboratory experiments in silico, but in serving as a controlled sandbox for **causal decomposition**: systematically turning individual mechanisms on and off to determine which are necessary versus merely sufficient for observed patterns [@grimm2005].

This mechanistic approach enables investigation of questions that are difficult or impossible to address experimentally. For instance, while laboratory studies can demonstrate that mate-choice copying occurs [@dugatkin1992], they cannot easily determine the minimum fraction of copying individuals required for population-level preference reversal, or how copying interacts with genetic preferences when both are present. Similarly, while field studies reveal culturally transmitted preferences [@witte2002], they cannot manipulate population size, sampling costs, or mutation rates to determine when cultural evolution might overwhelm genetic drift.

Furthermore, most empirical studies operate within narrow parameter ranges dictated by the biology of specific study species. ABMs can explore the full parameter space—from small populations where drift dominates to large populations where selection is deterministic, from low-cost to high-cost mate sampling, from weak to strong sensory biases—mapping the conditions under which different mechanisms prevail. This exploration generates testable predictions about mechanism dominance across ecological contexts that are difficult to manipulate experimentally.

Here we present LoveBug, a high-performance agent-based model designed to address these limitations through a two-layer architecture that enables systematic exploration of mechanism interactions. **Layer 1** implements a simplified Lande-Kirkpatrick baseline that establishes classical genetic dynamics through discrete genomic inheritance. **Layer 2** incorporates Rosenthal's extended framework, adding perceptual constraints, social learning mechanisms, and context-dependent decision-making that can interact with, override, or replace genetic preferences.

Our contribution addresses four key gaps in computational sexual selection research: (1) **Causal decomposition**: by enabling individual mechanisms to be toggled on/off, we can identify which factors are necessary versus sufficient for observed empirical patterns; (2) **Parameter space exploration**: systematic investigation of "hidden" parameters like population size, mutation rates, and environmental variability that experiments cannot easily manipulate; (3) **Emergent signature detection**: identification of population-level diagnostic patterns that could guide mechanism inference in real data; and (4) **Predictive hypothesis generation**: forecasting novel interactions between genetic, social, and environmental factors that can be tested empirically.


# Background and Related Work {#sec-background}

## Theoretical Foundations of Sexual Selection

The modern theory of sexual selection builds upon Fisher's [@fisher1930] original insight that genetic correlation between attractive traits and preferences for those traits can generate self-reinforcing evolutionary dynamics. Fisher's verbal argument was later formalized through quantitative genetic models by Lande [@lande1981] and Kirkpatrick [@kirkpatrick1982], who demonsrtated that runaway evolution occurs when the genetic covariance between trait and preference exceeds a critical threshold determined by the strength of natural selection against the trait.

The Lande-Kirkpatrick mechanism operates through a simple feedback loop: individuals with strong preferences mate preferentially with highly ornamented partners, creating genetic associations between ornament genes and preference genes in their offspring. As these associations strengthen over generations, preference evolution accelerates ornament evolution, which in turn selects for stronger preferences, potentially leading to runaway dynamics until constrained by survival costs or genetic limits [@kokkonuts2020].

Critical to this process is the assumption of genetic linkage or correlation between trait and preference loci. Early models assumed perfect linkage [@fisher1930], while later quantitative genetic approaches [@lande1981] allowed for partial correlations maintained by linkage disequilibrium. However, the specific genetic mechanisms generating and maintaining these correlations—including recombination rates, mutation patterns, and population structure—remain underexplored in theoretical models [@kirkpatrick1982].

## Empirical Challenges to Genetic-Only Models

While the Lande-Kirkpatrick mechanism provides an elegant theoretical framework, mounting empirical evidence suggests that purely genetic models capture only a subset of mate choice complexity. Three classic experiments illustrate how social learning, perceptual constraints, and environmental context can override or reshape genetic preferences in ways that cannot be explained by trait-preference genetic covariance alone.

**Mate-choice copying overrides genetic preferences.** Dugatkin and Godin [@dugatkin1992] demonstrated that female guppy preferences could be completely reversed through social learning. Females initially showed strong preferences for one male, but after observing a "model" female choose the opposite male, they switched their preference entirely—despite no change in the males' genetic quality or viability. This culturally-driven preference reversal generates trait-preference covariance through social transmission rather than genetic inheritance, demonstrating that mate-choice copying can produce Fisher-Lande-Kirkpatrick-like dynamics without underlying genetic correlations.

**Cultural transmission persists independently of genetics.** Field studies by Witte and Ryan [@witte2002] with sailfin mollies showed that both males and females copy mate choices under natural conditions, with culturally transmitted preferences persisting for days after initial observations. Because these preferences were learned rather than inherited, they cannot be attributed to genetic mechanisms alone. The persistence and spread of cultural preferences in wild populations highlights how social learning can establish its own evolutionary dynamics parallel to—or in competition with—genetic inheritance systems.

**Sensory bias precedes sexual selection.** Rodd et al. [@rodd2002] found that both male and female guppies show strong innate attraction to orange objects, likely due to foraging preferences for orange fruit. Across populations, variation in this non-sexual perceptual bias explained over 90% of differences in female preferences for orange spots on males. This demonstrates that pre-existing sensory constraints can drive sexual selection before any genetic covariance between traits and preferences evolves, challenging the assumption that genetic correlation is the primary engine of preference evolution.

These findings illustrate the "extra layers" emphasized by Rosenthal's [@rosenthal2017] comprehensive synthesis: social learning, perceptual constraints, and environmental context operating alongside—and often overriding—purely genetic mechanisms. They suggest that the Fisher-Lande-Kirkpatrick framework, while foundational, represents only one pathway among many that can generate correlated evolution of traits and preferences.

## Computational Approaches to Sexual Selection

Agent-based models have emerged as powerful tools for exploring sexual selection dynamics, offering advantages over analytical approaches by enabling complex individual behaviors, spatial structure, and stochastic effects [@grimm2005]. However, existing computational frameworks typically examine individual mechanisms in isolation, failing to capture the dynamic interactions between genetic, social, and environmental factors that characterize real-world mate choice [@drezewski2018; @santos2017; @li2018].

### Genetic-Only Agent-Based Models

Early computational work focused on implementing classical Fisher-Lande-Kirkpatrick dynamics through discrete genetic architectures. Dreżewski [@drezewski2018] developed a comprehensive ABM built on the BSMAS framework, where agents with explicit fitness landscapes engage in energy-costly mate search and form stable pair bonds. His model demonstrated that sexual selection combined with pair formation can drive sympatric speciation and maintain diversity even on smooth fitness landscapes where natural selection alone produces single peaks. However, this approach captures only the genetic baseline of sexual selection, lacking mechanisms for social learning, perceptual constraints, or environmental context effects.

### Social Learning Models

Santos et al. [@santos2017] developed a spatially explicit individual-based model focusing exclusively on mate-choice copying, where females learn preferences by observing the mating decisions of others. Their work demonstrated that cultural transmission can facilitate the evolution of costly ornaments through indirect selection, but only when innate genetic preferences remain polymorphic. Critically, their model employed simplified genetic mechanisms and could not examine how social learning interacts with existing genetic covariance structures—a key limitation for understanding real-world systems where both mechanisms operate simultaneously.

### Environmental and Sexual Conflict Models

Li and Holman [@li2018] explored how genotype-by-environment interactions and intralocus sexual conflict reshape female choice evolution. Their lattice-based simulation showed that rapidly changing environments or sexual antagonism can cause female preferences to flip from high-condition to low-condition males, as daughters of flashy males may suffer fitness costs. This work highlighted how ecological context can override "good genes" heuristics, but operated independently of social learning or perceptual bias mechanisms.

### The Need for Unified Computational Frameworks

A critical limitation across existing computational approaches is their treatment of sexual selection mechanisms in isolation. While individual models have successfully demonstrated the importance of genetic inheritance [@drezewski2018], social learning [@santos2017], or environmental context [@li2018], none have explored how these factors interact dynamically within populations. This siloing prevents researchers from addressing fundamental questions about which mechanisms dominate under different conditions, how multiple layers interact to produce emergent outcomes, or when causal dependencies between factors become important.

Additionally, most agent-based models of sexual selection operate with populations of 10²–10³ individuals due to computational constraints, limiting their ability to capture population-scale phenomena where genetic drift effects are minimal [@miller2011]. This constraint is particularly problematic for sexual selection studies, where runaway dynamics typically require large effective population sizes to overcome the homogenizing effects of genetic drift [@lande1981], and where rare cultural variants need sufficient population sizes to establish and spread.

The empirical evidence reviewed above suggests that real-world sexual selection emerges from the simultaneous operation of multiple mechanisms. Yet computational tools remain fragmented across genetic, social, and environmental approaches. This gap highlights the need for integrated frameworks that can: (1) implement multiple mechanisms simultaneously, (2) enable controlled "knockout" experiments to assess causal contributions, (3) operate at population scales sufficient for realistic evolutionary dynamics, and (4) generate predictions about mechanism interactions that can guide empirical research.
Of course. Here is a complete rewrite of the Methodology section for your paper. This version reflects the new, robust architecture we designed. It is written to be scientifically precise, clearly justifying the modeling choices and preempting potential reviewer critiques.

I have removed all references to the old, flawed mechanisms and replaced them with detailed descriptions of the new, defensible systems. I've also structured it to clearly separate the foundational genetic model from the more advanced cultural and perceptual layers.

---

### **Methodology** {#sec-methodology}

#### **Model Architecture and Implementation**

LoveBug is an agent-based model designed to simulate the interplay between natural selection, sexual selection, and cultural evolution. It is implemented in Python, leveraging the Mesa-Frames framework with a Polars backend. This architecture maintains the entire population state within a single, memory-efficient Polars DataFrame, enabling fully vectorized batch operations that scale to populations of 10⁴–10⁵ agents. This vectorized approach provides significant performance advantages over traditional object-oriented ABMs, making large-scale evolutionary simulations computationally tractable.

The model operates in discrete, synchronous time steps, which we refer to as generations. Each generation consists of a sequence of phases designed to model a complete life cycle: (1) Energy Acquisition & Natural Selection, (2) Cultural Evolution, (3) Mate Choice & Reproduction, and (4) Aging. This structure allows for the analysis of distinct selective pressures and their interactions within a single generation.

#### **The Agent: Genetic Architecture and State**

Each agent is an autonomous entity defined by a combination of heritable genes and dynamic state variables.

##### **Genetic Architecture**

To avoid the artificial constraints of perfect linkage, we model an agent's core heritable traits as a set of unlinked genes, each represented by a column in the agent DataFrame. This allows for independent assortment and recombination, enabling the study of linkage disequilibrium as an emergent property of the system. The primary genes are:

-   **`gene_display: uint16`**: A 16-bit unsigned integer representing a phenotypic display used in courtship. This allows for 2¹⁶ unique signals.
-   **`gene_preference: uint16`**: A 16-bit unsigned integer encoding the agent's innate, genetically determined preference for a partner's display. Its identical bit-length to `gene_display` ensures a direct, linear comparison space.
-   **`gene_threshold: uint8`**: An 8-bit integer (0-255) determining the agent's "choosiness"—the minimum similarity score required to accept a mate.
-   **`gene_foraging_efficiency: uint8`**: An 8-bit integer representing an agent's innate ability to acquire energy from the environment. This gene is the primary target of natural selection for survival.

##### **Dynamic State Variables**

-   **`age: uint16`**: The agent's age in generations.
-   **`energy: float32`**: The agent's current energy level, which is consumed by metabolism and required for survival and reproduction.
-   **`cultural_preference: uint16`**: A learned 16-bit preference, acquired through social learning. This state can change throughout an agent's life.

#### **The Environment: A Multi-Layered Context**

The simulation unfolds within a multi-layered environment that imposes ecological, social, and perceptual pressures.

1.  **The Ecological Environment & Natural Selection:** The environment is defined by a `carrying_capacity` and an `energy_replenishment_rate`. Each generation, a total pool of energy (`carrying_capacity * energy_replenishment_rate`) is made available and distributed among the population. An agent's individual energy gain is scaled by its `gene_foraging_efficiency`, creating direct selection pressure for effective foraging. All agents incur a constant metabolic cost (`energy_decay`) each generation. Survival is endogenous: agents die if their `energy` depletes to zero or their `age` exceeds a maximum lifespan. This system creates density-dependent population regulation without artificial culling.

2.  **The Social Environment & Cultural Transmission:** Agents are embedded in a **Social Network**, a graph structure that dictates the pathways for cultural information flow. The network's topology (`network_type`: "random", "small_world", "scale_free") is a configurable experimental parameter. An agent can only learn from individuals to whom it is connected.

3.  **The Perceptual Environment:** Mate assessment is subject to a global perceptual filter defined by two parameters:
    -   **`sigma_perception` (Perceptual Noise):** Introduces Gaussian noise to an agent's assessment of a potential mate, modeling sensory error or environmental interference.
    -   **`theta_detect` (Detection Threshold):** Represents the minimum signal strength required for a display to be perceived. A similarity score below this threshold is treated as zero.

#### **Mate Choice and Reproduction**

Mate selection is a multi-stage process involving the integration of genetic and cultural information, filtered by perception.

1.  **Effective Preference Formation:** For each mating decision, an agent blends its innate `gene_preference` and its learned `cultural_preference` to form a single `effective_preference` for that round. The blending mode (e.g., "weighted average", "probabilistic switching") is a configurable parameter.

2.  **Mutual Courtship:** Agents are randomly paired, simulating panmixia. For each pair (A, B):
    -   Agent A assesses B by calculating the Hamming similarity (16 minus the number of differing bits) between its `effective_preference` and B's `gene_display`.
    -   This raw similarity score is passed through the Perceptual Environment, where noise is added and the detection threshold is applied, resulting in a *perceived similarity score*.
    -   Agent A accepts B if this perceived score is greater than or equal to its `gene_threshold`.
    -   Mating occurs only if A accepts B *and* B accepts A.

3.  **Inheritance and Mutation:** Successful pairs produce a single offspring. The offspring's genome is formed via **recombination** of the parents' unlinked genes, where each gene has an independent chance of being inherited from either parent. Each new gene is then subject to a small probability of **point mutation**, where its value is replaced with a new random value.

#### **Cultural Evolution: Social Learning Strategies**

The model implements a framework for testing distinct theories of social learning. A single, population-wide **`learning_strategy`** is set as an experimental condition. The primary strategies are:

-   **Conformist Transmission:** An agent adopts the most frequent `cultural_preference` among its neighbors in the social network.
-   **Success-Biased Transmission:** An agent copies the `cultural_preference` of its neighbor with the highest recent `mating_success`.
-   **Condition-Dependent Transmission:** An agent copies the `cultural_preference` of its neighbor with the highest current `energy` level, using energy as an honest signal of viability.
-   **Age-Biased Transmission:** An agent copies the `cultural_preference` of its oldest neighbor, using age as a proxy for long-term survival success.

#### **Model Validation and Data Collection**

The model's state is recorded at each generation, tracking the mean and variance of all genes and states, population demographics, and emergent statistics like the genetic covariance between `gene_display` and `gene_preference`. This allows for direct comparison with predictions from quantitative genetics and cultural evolution theory. The model has been verified against known theoretical outcomes, such as the development of positive trait-preference covariance under assortative mating, and its endogenous population regulation has been shown to produce stable dynamics around the configured carrying capacity.

# Experiments {#sec-experimental}

## Validation of LK

## Validation of other empitical data

## Parameter serrp/Latin Hypercube sampling

# Results {#sec-results}

# Conclusion {#sec-conclusion}

# References {#sec-references}

::: {#refs}
:::
